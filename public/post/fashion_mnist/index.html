<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Chris&#39;s Data Blog  | Fashion Mnist Dataset</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.49.2" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.e08a958ae3e530145318b6373195c765.css" rel="stylesheet">
    

    

    
      
    

    

    <meta property="og:title" content="Fashion Mnist Dataset" />
<meta property="og:description" content="Load Librarylibrary(keras)Load Fashion Mnist Datasetfashion_mnist &lt;- dataset_fashion_mnist()c(train_images, train_labels) %&lt;-% fashion_mnist$trainc(test_images, test_labels) %&lt;-% fashion_mnist$test
Create Labelsclass_names = c(&#39;T-shirt/top&#39;,&#39;Trouser&#39;,&#39;Pullover&#39;,&#39;Dress&#39;,&#39;Coat&#39;, &#39;Sandal&#39;,&#39;Shirt&#39;,&#39;Sneaker&#39;,&#39;Bag&#39;,&#39;Ankle boot&#39;)Dimensionsdim(train_images)## [1] 60000 28 28dim(train_labels)## [1] 60000train_labels[1:20]## [1] 9 0 0 3 0 2 7 2 5 5 0 9 5 5 7 9 1 0 6 4dim(test_images)## [1] 10000 28 28dim(test_labels)## [1] 10000Take a look at Datalibrary(tidyr)library(ggplot2)image_1 &lt;- as." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/fashion_mnist/" />

<meta itemprop="name" content="Fashion Mnist Dataset">
<meta itemprop="description" content="Load Librarylibrary(keras)Load Fashion Mnist Datasetfashion_mnist &lt;- dataset_fashion_mnist()c(train_images, train_labels) %&lt;-% fashion_mnist$trainc(test_images, test_labels) %&lt;-% fashion_mnist$test
Create Labelsclass_names = c(&#39;T-shirt/top&#39;,&#39;Trouser&#39;,&#39;Pullover&#39;,&#39;Dress&#39;,&#39;Coat&#39;, &#39;Sandal&#39;,&#39;Shirt&#39;,&#39;Sneaker&#39;,&#39;Bag&#39;,&#39;Ankle boot&#39;)Dimensionsdim(train_images)## [1] 60000 28 28dim(train_labels)## [1] 60000train_labels[1:20]## [1] 9 0 0 3 0 2 7 2 5 5 0 9 5 5 7 9 1 0 6 4dim(test_images)## [1] 10000 28 28dim(test_labels)## [1] 10000Take a look at Datalibrary(tidyr)library(ggplot2)image_1 &lt;- as.">



<meta itemprop="wordCount" content="502">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Fashion Mnist Dataset"/>
<meta name="twitter:description" content="Load Librarylibrary(keras)Load Fashion Mnist Datasetfashion_mnist &lt;- dataset_fashion_mnist()c(train_images, train_labels) %&lt;-% fashion_mnist$trainc(test_images, test_labels) %&lt;-% fashion_mnist$test
Create Labelsclass_names = c(&#39;T-shirt/top&#39;,&#39;Trouser&#39;,&#39;Pullover&#39;,&#39;Dress&#39;,&#39;Coat&#39;, &#39;Sandal&#39;,&#39;Shirt&#39;,&#39;Sneaker&#39;,&#39;Bag&#39;,&#39;Ankle boot&#39;)Dimensionsdim(train_images)## [1] 60000 28 28dim(train_labels)## [1] 60000train_labels[1:20]## [1] 9 0 0 3 0 2 7 2 5 5 0 9 5 5 7 9 1 0 6 4dim(test_images)## [1] 10000 28 28dim(test_labels)## [1] 10000Take a look at Datalibrary(tidyr)library(ggplot2)image_1 &lt;- as."/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      Chris&#39;s Data Blog
    </a>
    <div class="flex-l items-center">
      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/contact/" title="Contact page">
              Contact
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/post/" title="Posts page">
              Posts
            </a>
          </li>
          
        </ul>
      
      


  <a href="fb.me/astronomerforfun" class="link-transition facebook link dib z-999 pt3 pt0-l mr2" title="Facebook link">
    <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

  </a>








    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  <article class="flex-l flex-wrap justify-between mw8 center ph3 ph0-l">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        POSTS
      </p>
      <h1 class="f1 athelas mb1">Fashion Mnist Dataset</h1>
      
      <time class="f6 mv4 dib tracked" datetime="0001-01-01T00:00:00Z">January 1, 0001</time>
    </header>

    <main class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><div id="load-library" class="section level1">
<h1>Load Library</h1>
<pre class="r"><code>library(keras)</code></pre>
</div>
<div id="load-fashion-mnist-dataset" class="section level1">
<h1>Load Fashion Mnist Dataset</h1>
<pre class="r"><code>fashion_mnist &lt;- dataset_fashion_mnist()

c(train_images, train_labels) %&lt;-% fashion_mnist$train
c(test_images, test_labels) %&lt;-% fashion_mnist$test</code></pre>
<p><br></p>
</div>
<div id="create-labels" class="section level1">
<h1>Create Labels</h1>
<pre class="r"><code>class_names = c(&#39;T-shirt/top&#39;,
                &#39;Trouser&#39;,
                &#39;Pullover&#39;,
                &#39;Dress&#39;,
                &#39;Coat&#39;, 
                &#39;Sandal&#39;,
                &#39;Shirt&#39;,
                &#39;Sneaker&#39;,
                &#39;Bag&#39;,
                &#39;Ankle boot&#39;)</code></pre>
</div>
<div id="dimensions" class="section level1">
<h1>Dimensions</h1>
<pre class="r"><code>dim(train_images)</code></pre>
<pre><code>## [1] 60000    28    28</code></pre>
<pre class="r"><code>dim(train_labels)</code></pre>
<pre><code>## [1] 60000</code></pre>
<pre class="r"><code>train_labels[1:20]</code></pre>
<pre><code>##  [1] 9 0 0 3 0 2 7 2 5 5 0 9 5 5 7 9 1 0 6 4</code></pre>
<pre class="r"><code>dim(test_images)</code></pre>
<pre><code>## [1] 10000    28    28</code></pre>
<pre class="r"><code>dim(test_labels)</code></pre>
<pre><code>## [1] 10000</code></pre>
</div>
<div id="take-a-look-at-data" class="section level1">
<h1>Take a look at Data</h1>
<pre class="r"><code>library(tidyr)
library(ggplot2)

image_1 &lt;- as.data.frame(train_images[1, , ])
colnames(image_1) &lt;- seq_len(ncol(image_1))
image_1$y &lt;- seq_len(nrow(image_1))
image_1 &lt;- gather(image_1, &quot;x&quot;, &quot;value&quot;, -y)
image_1$x &lt;- as.integer(image_1$x)

ggplot(image_1, aes(x = x, y = y, fill = value)) +
  geom_tile() +
  scale_fill_gradient(low = &quot;white&quot;, high = &quot;black&quot;, na.value = NA) +
  scale_y_reverse() +
  theme_minimal() +
  theme(panel.grid = element_blank())   +
  theme(aspect.ratio = 1) +
  xlab(&quot;&quot;) +
  ylab(&quot;&quot;)</code></pre>
<p><img src="/post/fashion_mnist_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>train_images &lt;- train_images / 255
test_images &lt;- test_images / 255</code></pre>
<pre class="r"><code>par(mfcol=c(5,5))
par(mar=c(0, 0, 1.5, 0), xaxs=&#39;i&#39;, yaxs=&#39;i&#39;)
for (i in 1:25) { 
  img &lt;- train_images[i, , ]
  img &lt;- t(apply(img, 2, rev)) 
  image(1:28, 1:28, img, col = gray((0:255)/255), xaxt = &#39;n&#39;, yaxt = &#39;n&#39;,
        main = paste(class_names[train_labels[i] + 1]))
}</code></pre>
<p><img src="/post/fashion_mnist_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="build-out-model" class="section level1">
<h1>Build out Model</h1>
<pre class="r"><code>model &lt;- keras_model_sequential()
model %&gt;%
  layer_flatten(input_shape = c(28, 28)) %&gt;%
  layer_dense(units = 128, activation = &#39;relu&#39;) %&gt;%
  layer_dense(units = 10, activation = &#39;softmax&#39;)</code></pre>
</div>
<div id="create-optimizer-function" class="section level1">
<h1>Create Optimizer Function</h1>
<pre class="r"><code>model %&gt;% compile(
  optimizer = &#39;adam&#39;, 
  loss = &#39;sparse_categorical_crossentropy&#39;,
  metrics = c(&#39;accuracy&#39;)
)</code></pre>
</div>
<div id="run-neural-net" class="section level1">
<h1>Run Neural Net</h1>
<pre class="r"><code>model %&gt;% fit(train_images, train_labels, epochs = 5)</code></pre>
</div>
<div id="look-at-models-accuracy" class="section level1">
<h1>Look at modelâ€™s accuracy</h1>
<pre class="r"><code>score &lt;- model %&gt;% evaluate(test_images, test_labels)

cat(&#39;Test loss:&#39;, score$loss, &quot;\n&quot;)</code></pre>
<pre><code>## Test loss: 0.3361137</code></pre>
<pre class="r"><code>cat(&#39;Test accuracy:&#39;, score$acc, &quot;\n&quot;)</code></pre>
<pre><code>## Test accuracy: 0.8788</code></pre>
</div>
<div id="make-predictions-on-test-images" class="section level1">
<h1>Make Predictions on Test Images</h1>
<pre class="r"><code>predictions &lt;- model %&gt;% predict(test_images)</code></pre>
<pre class="r"><code>predictions[1, ]</code></pre>
<pre><code>##  [1] 2.733443e-05 6.023087e-07 1.070649e-06 1.364500e-07 9.585458e-07
##  [6] 9.954358e-03 5.134001e-05 3.730502e-02 3.399917e-05 9.526252e-01</code></pre>
<pre class="r"><code>class_pred &lt;- model %&gt;% predict_classes(test_images)
class_pred[1:20]</code></pre>
<pre><code>##  [1] 9 2 1 1 6 1 4 6 5 7 4 5 7 3 4 1 2 2 8 0</code></pre>
<pre class="r"><code>par(mfcol=c(5,5))
par(mar=c(0, 0, 1.5, 0), xaxs=&#39;i&#39;, yaxs=&#39;i&#39;)
for (i in 1:25) { 
  img &lt;- test_images[i, , ]
  img &lt;- t(apply(img, 2, rev)) 
  # subtract 1 as labels go from 0 to 9
  predicted_label &lt;- which.max(predictions[i, ]) - 1
  true_label &lt;- test_labels[i]
  if (predicted_label == true_label) {
    color &lt;- &#39;#008800&#39; 
  } else {
    color &lt;- &#39;#bb0000&#39;
  }
  image(1:28, 1:28, img, col = gray((0:255)/255), xaxt = &#39;n&#39;, yaxt = &#39;n&#39;,
        main = paste0(class_names[predicted_label + 1], &quot; (&quot;,
                      class_names[true_label + 1], &quot;)&quot;),
        col.main = color)
}</code></pre>
<p><img src="/post/fashion_mnist_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code># Grab an image from the test dataset
# take care to keep the batch dimension, as this is expected by the model
img &lt;- test_images[1, , , drop = FALSE]
dim(img)</code></pre>
<pre><code>## [1]  1 28 28</code></pre>
<pre class="r"><code>predictions &lt;- model %&gt;% predict(img)
predictions</code></pre>
<pre><code>##              [,1]         [,2]         [,3]         [,4]         [,5]
## [1,] 2.733443e-05 6.023087e-07 1.070649e-06 1.364497e-07 9.585476e-07
##             [,6]         [,7]       [,8]         [,9]     [,10]
## [1,] 0.009954349 5.133991e-05 0.03730503 3.399911e-05 0.9526252</code></pre>
<pre class="r"><code># subtract 1 as labels are 0-based
prediction &lt;- predictions[1, ] - 1
which.max(prediction)</code></pre>
<pre><code>## [1] 10</code></pre>
<pre class="r"><code>class_pred &lt;- model %&gt;% predict_classes(img)
class_pred</code></pre>
<pre><code>## [1] 9</code></pre>
</div>
<ul class="pa0">
  
</ul>
<div class="mt6">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "www-shockleysblog-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    </main>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-near-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="/" >
    &copy; 2019 Chris&#39;s Data Blog
  </a>
    <div>


  <a href="fb.me/astronomerforfun" class="link-transition facebook link dib z-999 pt3 pt0-l mr2" title="Facebook link">
    <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

  </a>







</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
