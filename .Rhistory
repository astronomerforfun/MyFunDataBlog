tuneGrid <- data.frame(.mtry = c(2,3,5,9),
.splitrule = "variance", .min.node.size = 5)
model <- train(mpg ~ .,
data = mtcars,
method = "ranger",
tuneGrid = tuneGrid,
trControl = trainControl(method = "cv",
number =2,
verboseIter = TRUE)))
tuneGrid <- data.frame(.mtry = c(2,3,5,9),
.splitrule = "variance", .min.node.size = 5)
model <- train(mpg ~ .,
data = mtcars,
method = "ranger",
tuneGrid = tuneGrid,
trControl = trainControl(method = "cv",
number =2,
verboseIter = TRUE))
plot(model)
tuneGrid <- data.frame(.mtry = c(2,3,5,9),
.splitrule = "variance", .min.node.size = 2)
model <- train(mpg ~ .,
data = mtcars,
method = "ranger",
tuneGrid = tuneGrid,
trControl = trainControl(method = "cv",
number =2,
verboseIter = TRUE))
plot(model)
tuneGrid <- data.frame(.mtry = c(2,3,5,9),
.splitrule = "variance", .min.node.size = 7)
model <- train(mpg ~ .,
data = mtcars,
method = "ranger",
tuneGrid = tuneGrid,
trControl = trainControl(method = "cv",
number =2,
verboseIter = TRUE))
plot(model)
tuneGrid <- data.frame(.mtry = c(2,3,5,6,7,8,9),
.splitrule = "variance", .min.node.size = )
tuneGrid <- data.frame(.mtry = c(2,3,5,6,7,8,9),
.splitrule = "variance", .min.node.size = 5)
model <- train(mpg ~ .,
data = mtcars,
method = "ranger",
tuneGrid = tuneGrid,
trControl = trainControl(method = "cv",
number =2,
verboseIter = TRUE))
plot(model)
tuneGrid <- data.frame(mtry = c(2,3,5,6,7,8,9),
splitrule = "variance", min.node.size = 5)
model <- train(mpg ~ .,
data = mtcars,
method = "ranger",
tuneGrid = tuneGrid,
trControl = trainControl(method = "cv",
number =2,
verboseIter = TRUE))
plot(model)
tuneGrid <- data.frame(mtry = c(2,3,5,6,7,8,9),
splitrule = "variance", min.node.size = 5)
model <- train(mpg ~ .,
data = mtcars,
method = "ranger",
tuneLength = 5,
trControl = trainControl(method = "cv",
number =2,
verboseIter = TRUE))
plot(model)
summary(model)
model
library(caret)
library(ggplot2)
library(ranger)
library(devtools)
install_github("modelplot/modelplotr")
library(caret)
library(ggplot2)
library(ranger)
library(devtools)
library(modelplotr)
# prepare data for training and train models
test_size = 0.3
train_index =  sample(seq(1, nrow(bank)),size = (1 - test_size)*nrow(bank) ,replace = F)
train = bank[train_index,]
test = bank[-train_index,]
# estimate some models with caret...
# setting caret cross validation, here tuned for speed (not accuracy!)
fitControl  caret::trainControl(method = "cv",number = 2,classProbs=TRUE)
# mnl model using glmnet package
mnl = caret::train(y ~.,data = train, method = "glmnet",trControl = fitControl)
# random forest using ranger package, here tuned for speed (not accuracy!)
rf = caret::train(y ~.,data = train, method = "ranger",trControl = fitControl,
tuneGrid = expand.grid(.mtry = 2,.splitrule = "gini",.min.node.size=10))
# ... and estimate some models with mlr
task = mlr::makeClassifTask(data = train, target = "y")
# discriminant model
lrn = mlr::makeLearner("classif.lda", predict.type = "prob")
lda = mlr::train(lrn, task)
#xgboost model
lrn = mlr::makeLearner("classif.xgboost", predict.type = "prob")
xgb = mlr::train(lrn, task)
li
# prepare data for training and train models
test_size = 0.3
train_index =  sample(seq(1, nrow(bank)),size = (1 - test_size)*nrow(bank) ,replace = F)
train = bank[train_index,]
test = bank[-train_index,]
# estimate some models with caret...
# setting caret cross validation, here tuned for speed (not accuracy!)
fitControl  caret::trainControl(method = "cv",number = 2,classProbs=TRUE)
# mnl model using glmnet package
mnl = caret::train(y ~.,data = train, method = "glmnet",trControl = fitControl)
# random forest using ranger package, here tuned for speed (not accuracy!)
rf = caret::train(y ~.,data = train, method = "ranger",trControl = fitControl,
tuneGrid = expand.grid(.mtry = 2,.splitrule = "gini",.min.node.size=10))
tuneGrid <- data.frame(mtry = c(2,3,5,6,7,8,9),
splitrule = "variance", min.node.size = 5)
model <- train(mpg ~ .,
data = mtcars,
method = "ranger",
tuneLength = 5,
trControl = trainControl(method = "cv",
number =2,
verboseIter = TRUE))
model
plot(model)
str(mtcars)
?mtcars
rows <- sample(nrow(mtcars), nrow(mtcars) * .75, replace = F)
train <- mtcars[rows,]
test <- mtcars[-rows,]
model <- train(mpg ~ .,
data = train,
method = "lm",
trControl = trainControl(
method = "cv", number = 5,
repeats = 5, verboseIter = TRUE
)
)
model
rows <- sample(nrow(mtcars), nrow(mtcars) * .75, replace = F)
train <- mtcars[rows,]
test <- mtcars[-rows,]
model <- train(mpg ~ .,
data = mtcars,
method = "lm",
trControl = trainControl(
method = "cv", number = 5,
repeats = 5, verboseIter = TRUE
)
)
model
model <- train(mpg ~ .,
data = mtcars,
method = "lm",
trControl = trainControl(
method = "cv", number = 5,
repeats = 5, verboseIter = FALSE
)
)
model
prediction <- predict(model, mtcars)
prediction <- predict(model, mtcars)
confusionMatrix(prediction, mtcars$mpg)
prediction <- predict(model, mtcars)
confusionMatrix(prediction, mtcars)
prediction <- predict(model, mtcars)
prediction
confusionMatrix(prediction, mtcars$mpg)
plot(model)
pred <- predict(model, mtcars)
confusionMatrix(pred, mtcars$mpg)
pred
#calculate RMSE
rmse <- pred - mtcars$mpg
mean(rmse^2)
pred <- predict(model, mtcars)
#calculate RMSE
rmse <- pred - mtcars$mpg
sqrt(mean(rmse^2))
hist(mtcars)
hist(mtcars$mpg)
tuneGrid <- data.frame(mtry = c(2,3,5,6,7,8,9),
splitrule = "variance", min.node.size = 5)
model <- train(binary ~ .,
data = mtcars,
method = "glm",
tuneLength = 5,
trControl = trainControl(method = "cv",
number =2,
verboseIter = TRUE))
mtcars$binary <- ifelse(mtcars$mpg > 20, "Not Good", "Good")
tuneGrid <- data.frame(mtry = c(2,3,5,6,7,8,9),
splitrule = "variance", min.node.size = 5)
model <- train(binary ~ .,
data = mtcars,
method = "glm",
tuneLength = 5,
trControl = trainControl(method = "cv",
number =2,
verboseIter = TRUE))
model
plot(model)
model
sonar
Sonar
library(datsets)
library(datsets)
install.packages("mlbench")
library(caret)
library(ggplot2)
library(ranger)
library(devtools)
library(modelplotr)
library(mlbench)
?Sonar
str(Sonar)
str(Sonar)
str(sonar)
Sonar
library(caret)
library(ggplot2)
library(ranger)
library(devtools)
library(modelplotr)
library(mlbench)
data("Sonar")
sonar <- data("Sonar")
str(sonar)
sonar <- data(Sonar)
str(sonar)
View(sonar)
library(caret)
library(ggplot2)
library(ranger)
library(devtools)
library(modelplotr)
library(mlbench)
Sonar
sonar <- Sonar
str(sonar)
sonar <- Sonar
rows <- sample(nrow(sonar), nrow(sonar) * .6, replace = FALSE)
train <- sonar[rows,]
test <- sonar[-rows,]
str(sonar)
modelsonar <- train(Class ~ .,
data = train,
method = "glm",
trControl = trainControl(method = "cv",
number = 5, repeats = 5,verboseIter = F))
modelsonar <- train(Class ~ .,
data = train,
method = "glm",
trControl = trainControl(method = "cv",
number = 5,verboseIter = F))
myControl <- trainControl(
method = "cv",
number = 10,
summaryFunction = twoClassSummary,
classProbs = TRUE, # IMPORTANT!
verboseIter = TRUE
)
modelsonar <- train(Class ~ .,
data = train,
method = "glm",
trControl = myControl)
modelsonar
myControl <- trainControl(
method = "cv",
number = 10,
summaryFunction = twoClassSummary,
classProbs = TRUE, # IMPORTANT!
verboseIter = TRUE
)
modelsonar <- train(Class ~ .,
data = sonar,
method = "glm",
trControl = myControl)
modelsonar
myControl <- trainControl(
method = "cv",
number = 10,
summaryFunction = twoClassSummary,
classProbs = TRUE, # IMPORTANT!
verboseIter = TRUE
)
modelsonar <- train(Class ~ .,
data = sonar,
method = "glm",
trControl = myControl)
modelsonar
pred2 <- predict(modelsonar, test)
confusionMatrix(pred2, test$Class)
myControl <- trainControl(
method = "cv",
number = 10,
summaryFunction = twoClassSummary,
classProbs = TRUE, # IMPORTANT!
verboseIter = TRUE
)
modelsonar <- train(Class ~ .,
data = train,
method = "glm",
trControl = myControl)
modelsonar
pred2 <- predict(modelsonar, test)
confusionMatrix(pred2, test$Class)
sonar <- Sonar
rows <- sample(nrow(sonar), nrow(sonar) * .8, replace = FALSE)
train <- sonar[rows,]
test <- sonar[-rows,]
myControl <- trainControl(
method = "cv",
number = 10,
summaryFunction = twoClassSummary,
classProbs = TRUE, # IMPORTANT!
verboseIter = TRUE
)
modelsonar <- train(Class ~ .,
data = train,
method = "glm",
trControl = myControl)
modelsonar
pred2 <- predict(modelsonar, test)
confusionMatrix(pred2, test$Class)
colAUC(p, test[["Class"]], plotROC = TRUE)
myControl <- trainControl(
method = "cv",
number = 10,
summaryFunction = twoClassSummary,
classProbs = TRUE, # IMPORTANT!
verboseIter = TRUE
)
modelsonar <- train(Class ~ .,
data = train,
method = "glm",
trControl = myControl)
modelsonar
colAUC(pred2, test[["Class"]], plotROC = TRUE)
myControl <- trainControl(
method = "cv",
number = 10,
summaryFunction = twoClassSummary,
classProbs = TRUE, # IMPORTANT!
verboseIter = TRUE
)
modelsonar <- train(Class ~ .,
data = train,
method = "glm",
trControl = myControl)
modelsonar
pred2 <- predict(modelsonar, test)
confusionMatrix(pred2, test$Class)
colAUC(pred2, test[["Class"]], plotROC = TRUE)
colAUC(pred2, test$Class, plotROC = TRUE)
colAUC(pred2, test$Class, plotROC = TRUE)
library(caret)
library(ggplot2)
library(ranger)
library(devtools)
library(modelplotr)
library(mlbench)
library(caTools)
colAUC(pred2, test$Class, plotROC = TRUE)
sonar <- Sonar
rows <- sample(nrow(sonar), nrow(sonar) * .8, replace = FALSE)
train <- sonar[rows,]
test <- sonar[-rows,]
pred2 <- predict(modelsonar, test, type = "response")
pred2 <- predict(modelsonar, test, type = "prob")
pred2 <- predict(modelsonar, test, type = "prob")
colAUC(pred2, test$Class, plotROC = TRUE)
pred2 <- predict(modelsonar, test, type = "response")
pred2 <- predict(modelsonar, test, type = "response")
pred2 <- predict(modelsonar, test)
colAUC(pred2, test$Class, plotROC = TRUE)
pred2 <- predict(modelsonar, test, response = "prob")
colAUC(pred2, test$Class, plotROC = TRUE)
pred2 <- predict(modelsonar, test, type = "prob")
modelsonar
sonar <- Sonar
rows <- sample(nrow(sonar), nrow(sonar) * .8, replace = FALSE)
train <- sonar[rows,]
test <- sonar[-rows,]
myControl <- trainControl(
method = "cv",
number = 10,
summaryFunction = twoClassSummary,
classProbs = TRUE, # IMPORTANT!
verboseIter = TRUE
)
modelsonar <- train(Class ~ .,
data = train,
method = "glm",
trControl = myControl)
modelsonar
pred2 <- predict(modelsonar, test, type = "prob")
colAUC(pred2, test$Class, plotROC = TRUE)
confusionMatrix(pred2, test$Class)
confusionMatrix(pred2, test[["Class"]])
table(pred2, test$Class)
sonar <- Sonar
rows <- sample(nrow(sonar), nrow(sonar) * .8, replace = FALSE)
train <- sonar[rows,]
test <- sonar[-rows,]
nrow(Sonar)
Sonar
rows <- sample(nrow(Sonar), nrow(Sonar) * .7, replace = FALSE)
train <- Sonar[rows,]
test <- Sonar[-rows,]
library(caret)
library(ggplot2)
library(ranger)
library(devtools)
library(modelplotr)
library(mlbench)
library(caTools)
df <- Sonar
knitr::opts_chunk$set(echo = TRUE)
rows <- sample(nrow(Sonar), nrow(Sonar) * .7, replace = FALSE)
train <- Sonar[rows,]
test <- Sonar[-rows,]
test
rows <- sample(nrow(Sonar), nrow(Sonar) * .7, replace = FALSE)
train <- Sonar[rows,]
test <- Sonar[-rows,]
Sonar <- data(Sonar)
rows <- sample(nrow(Sonar), nrow(Sonar) * .7, replace = FALSE)
data(Sonar)
summary(Sonar)
df <- data(Sonar)
rows <- sample(nrow(df), nrow(df) * .7, replace = FALSE)
df
df <- Sonar
df <- Sonar
rows <- sample(nrow(df), nrow(df) * .7, replace = FALSE)
train <- df[rows,]
test <- df[-rows,]
class(Sonar)
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(ggplot2)
library(ranger)
library(devtools)
library(modelplotr)
library(mlbench)
library(caTools)
str(mtcars)
model <- train(mpg ~ .,
data = mtcars,
method = "lm",
trControl = trainControl(
method = "cv", number = 5,
repeats = 5, verboseIter = FALSE
)
)
model
pred <- predict(model, mtcars)
#calculate RMSE
rmse <- pred - mtcars$mpg
sqrt(mean(rmse^2))
df <- Sonar
df <- Sonar
library(caret)
library(ggplot2)
library(ranger)
library(devtools)
library(modelplotr)
library(mlbench)
library(caTools)
df <- Sonar
df <- data(Sonar)
rows <- sample(nrow(df), nrow(df) * .7, replace = FALSE)
Sonar
rows <- sample(nrow(Sonar), nrow(Sonar) * .8, replace = FALSE)
train <- Sonar[rows,]
test <- Sonar[-rows,]
unlink('C:/Users/cshockley/Desktop/caret2_cache', recursive = TRUE)
df <- as.data.frame(data(Sonar))
rows <- sample(nrow(Sonar), nrow(Sonar) * .8, replace = FALSE)
train <- Sonar[rows,]
test <- Sonar[-rows,]
df
df <- data(Sonar)
df
Boston
library(caret)
library(ggplot2)
library(ranger)
library(devtools)
library(modelplotr)
library(mlbench)
library(caTools)
library(MASS)
Boston
# rows <- sample(nrow(Sonar), nrow(Sonar) * .8, replace = FALSE)
# train <- Sonar[rows,]
# test <- Sonar[-rows,]
knitr::opts_chunk$set(echo = TRUE)
library(tfestimators)
install_tensorflow()
library(tfestimators)
install_tensorflow()
library(tfestimators)
install_tensorflow()
setwd("C:/Users/cshockley/Desktop/WEBSITE_BLOG")
library(blogdown)
serve_site()
